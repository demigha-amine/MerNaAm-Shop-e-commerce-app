{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport { removePanier } from \"../../features/panier/panierSlice\";\nimport axios from \"axios\";\nconst usePanier = () => {\n  _s();\n  const listPanier = useSelector(state => state.panier);\n  const [isLoading, setisLoading] = useState(false);\n  const [isError, setisError] = useState(false);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  // calcul du total\n  const total = listPanier.reduce((acc, cur) => {\n    return acc + cur.annonce.prix * cur.qteAchat;\n  }, 0);\n\n  // redirect vers la page de payement en ligne\n  const checkout = () => {\n    if (listPanier.length === 0) return setisError(\"Votre panier est vide\");\n    setisLoading(true);\n    axios.post(\"/api/commande/checkout\", listPanier).then(res => window.location = res.data.url).catch(err => console.log(err.response)).finally(() => setisLoading(false));\n  };\n\n  // Supprime l'annonce du panier\n  const deleteFromPanier = id => {\n    setisLoading(true);\n    axios.delete(`/api/panier/${id}`).then(() => {\n      dispatch(removePanier(id));\n    }).catch(err => console.log(err.response)).finally(() => setisLoading(false));\n  };\n\n  // nous envoie vers la page de détails d'une annonce pour mettre à jours la Qte\n  const updateInPanier = url => navigate(url);\n  return {\n    listPanier,\n    isLoading,\n    isError,\n    total,\n    checkout,\n    deleteFromPanier,\n    updateInPanier\n  };\n};\n_s(usePanier, \"Diu0qz9nmzWOT25X68bMgAqoE6g=\", false, function () {\n  return [useSelector, useDispatch, useNavigate];\n});\nexport default usePanier;","map":{"version":3,"names":["useState","useSelector","useNavigate","useDispatch","removePanier","axios","usePanier","_s","listPanier","state","panier","isLoading","setisLoading","isError","setisError","dispatch","navigate","total","reduce","acc","cur","annonce","prix","qteAchat","checkout","length","post","then","res","window","location","data","url","catch","err","console","log","response","finally","deleteFromPanier","id","delete","updateInPanier"],"sources":["C:/Users/Amine/Pictures/PROJET/client/src/pages/Panier/usePanier.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { removePanier } from \"../../features/panier/panierSlice\";\r\nimport axios from \"axios\";\r\n\r\nconst usePanier = () => {\r\n  const listPanier = useSelector((state) => state.panier);\r\n  const [isLoading, setisLoading] = useState(false);\r\n  const [isError, setisError] = useState(false);\r\n\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  // calcul du total\r\n  const total = listPanier.reduce((acc, cur) => {\r\n    return acc + cur.annonce.prix * cur.qteAchat;\r\n  }, 0);\r\n\r\n  // redirect vers la page de payement en ligne\r\n  const checkout = () => {\r\n    if (listPanier.length === 0) return setisError(\"Votre panier est vide\");\r\n\r\n    setisLoading(true);\r\n    axios\r\n      .post(\"/api/commande/checkout\", listPanier)\r\n      .then((res) => (window.location = res.data.url))\r\n      .catch((err) => console.log(err.response))\r\n      .finally(() => setisLoading(false));\r\n  };\r\n\r\n  // Supprime l'annonce du panier\r\n  const deleteFromPanier = (id) => {\r\n    setisLoading(true);\r\n    axios\r\n      .delete(`/api/panier/${id}`)\r\n      .then(() => {\r\n        dispatch(removePanier(id));\r\n      })\r\n      .catch((err) => console.log(err.response))\r\n      .finally(() => setisLoading(false));\r\n  };\r\n\r\n  // nous envoie vers la page de détails d'une annonce pour mettre à jours la Qte\r\n  const updateInPanier = (url) => navigate(url);\r\n\r\n  return {\r\n    listPanier,\r\n    isLoading,\r\n    isError,\r\n    total,\r\n    checkout,\r\n    deleteFromPanier,\r\n    updateInPanier,\r\n  };\r\n};\r\nexport default usePanier;\r\n"],"mappings":";AAAA,SAASA,QAAQ,QAAQ,OAAO;AAChC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,YAAY,QAAQ,mCAAmC;AAChE,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAMC,UAAU,GAAGP,WAAW,CAAEQ,KAAK,IAAKA,KAAK,CAACC,MAAM,CAAC;EACvD,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAE7C,MAAMe,QAAQ,GAAGZ,WAAW,CAAC,CAAC;EAC9B,MAAMa,QAAQ,GAAGd,WAAW,CAAC,CAAC;;EAE9B;EACA,MAAMe,KAAK,GAAGT,UAAU,CAACU,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;IAC5C,OAAOD,GAAG,GAAGC,GAAG,CAACC,OAAO,CAACC,IAAI,GAAGF,GAAG,CAACG,QAAQ;EAC9C,CAAC,EAAE,CAAC,CAAC;;EAEL;EACA,MAAMC,QAAQ,GAAGA,CAAA,KAAM;IACrB,IAAIhB,UAAU,CAACiB,MAAM,KAAK,CAAC,EAAE,OAAOX,UAAU,CAAC,uBAAuB,CAAC;IAEvEF,YAAY,CAAC,IAAI,CAAC;IAClBP,KAAK,CACFqB,IAAI,CAAC,wBAAwB,EAAElB,UAAU,CAAC,CAC1CmB,IAAI,CAAEC,GAAG,IAAMC,MAAM,CAACC,QAAQ,GAAGF,GAAG,CAACG,IAAI,CAACC,GAAI,CAAC,CAC/CC,KAAK,CAAEC,GAAG,IAAKC,OAAO,CAACC,GAAG,CAACF,GAAG,CAACG,QAAQ,CAAC,CAAC,CACzCC,OAAO,CAAC,MAAM1B,YAAY,CAAC,KAAK,CAAC,CAAC;EACvC,CAAC;;EAED;EACA,MAAM2B,gBAAgB,GAAIC,EAAE,IAAK;IAC/B5B,YAAY,CAAC,IAAI,CAAC;IAClBP,KAAK,CACFoC,MAAM,CAAE,eAAcD,EAAG,EAAC,CAAC,CAC3Bb,IAAI,CAAC,MAAM;MACVZ,QAAQ,CAACX,YAAY,CAACoC,EAAE,CAAC,CAAC;IAC5B,CAAC,CAAC,CACDP,KAAK,CAAEC,GAAG,IAAKC,OAAO,CAACC,GAAG,CAACF,GAAG,CAACG,QAAQ,CAAC,CAAC,CACzCC,OAAO,CAAC,MAAM1B,YAAY,CAAC,KAAK,CAAC,CAAC;EACvC,CAAC;;EAED;EACA,MAAM8B,cAAc,GAAIV,GAAG,IAAKhB,QAAQ,CAACgB,GAAG,CAAC;EAE7C,OAAO;IACLxB,UAAU;IACVG,SAAS;IACTE,OAAO;IACPI,KAAK;IACLO,QAAQ;IACRe,gBAAgB;IAChBG;EACF,CAAC;AACH,CAAC;AAACnC,EAAA,CAjDID,SAAS;EAAA,QACML,WAAW,EAIbE,WAAW,EACXD,WAAW;AAAA;AA4C9B,eAAeI,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}