{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { setAnnonces, setFiltre, reset } from \"../../features/accueil/accueilSlice\";\nimport axios from \"axios\";\nconst useAccueil = () => {\n  _s();\n  const [isLoading, setisLoading] = useState(false);\n  const dispatch = useDispatch();\n  const {\n    annonces,\n    filtre,\n    nbrPages\n  } = useSelector(state => state.accueil);\n  const [name, setname] = useState(filtre.name);\n  const [category, setcategory] = useState(filtre.category);\n\n  // Récupere les annonces à l'ouverture du site et au changement du filtre\n  useEffect(() => {\n    setisLoading(true);\n    let urlFiltre = `name=${filtre.name}&category=${filtre.category}&page=${filtre.page}`;\n    axios.get(`/api/annonce?${urlFiltre}`).then(res => dispatch(setAnnonces(res.data))).catch(err => console.log(err.response)).finally(() => setisLoading(false));\n  }, [dispatch, filtre]);\n\n  // filtre les annonces\n  const searchProduit = () => dispatch(setFiltre({\n    name,\n    category\n  }));\n\n  // reset les filtres de recherche\n  const resetSearch = () => {\n    dispatch(reset());\n    setname(\"\");\n    setcategory(\"\");\n  };\n\n  // mets a jours la page de l'affichage\n  const updatePage = i => dispatch(setFiltre({\n    page: i + 1\n  }));\n  return {\n    annonces,\n    filtre,\n    nbrPages,\n    isLoading,\n    name,\n    category,\n    searchProduit,\n    resetSearch,\n    updatePage,\n    setname,\n    setcategory\n  };\n};\n_s(useAccueil, \"hJWP2J6Mr5Xgq48euu3KZLSwJ5E=\", false, function () {\n  return [useDispatch, useSelector];\n});\nexport default useAccueil;","map":{"version":3,"names":["useEffect","useState","useDispatch","useSelector","setAnnonces","setFiltre","reset","axios","useAccueil","_s","isLoading","setisLoading","dispatch","annonces","filtre","nbrPages","state","accueil","name","setname","category","setcategory","urlFiltre","page","get","then","res","data","catch","err","console","log","response","finally","searchProduit","resetSearch","updatePage","i"],"sources":["C:/Users/Meryem/OneDrive/Desktop/PROJET/client/src/pages/Accueil/useAccueil.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  setAnnonces,\r\n  setFiltre,\r\n  reset,\r\n} from \"../../features/accueil/accueilSlice\";\r\nimport axios from \"axios\";\r\n\r\nconst useAccueil = () => {\r\n  const [isLoading, setisLoading] = useState(false);\r\n  const dispatch = useDispatch();\r\n\r\n  const { annonces, filtre, nbrPages } = useSelector((state) => state.accueil);\r\n  const [name, setname] = useState(filtre.name);\r\n  const [category, setcategory] = useState(filtre.category);\r\n\r\n  // Récupere les annonces à l'ouverture du site et au changement du filtre\r\n  useEffect(() => {\r\n    setisLoading(true);\r\n    let urlFiltre = `name=${filtre.name}&category=${filtre.category}&page=${filtre.page}`;\r\n    axios\r\n      .get(`/api/annonce?${urlFiltre}`)\r\n      .then((res) => dispatch(setAnnonces(res.data)))\r\n      .catch((err) => console.log(err.response))\r\n      .finally(() => setisLoading(false));\r\n  }, [dispatch, filtre]);\r\n\r\n  // filtre les annonces\r\n  const searchProduit = () => dispatch(setFiltre({ name, category }));\r\n\r\n  // reset les filtres de recherche\r\n  const resetSearch = () => {\r\n    dispatch(reset());\r\n    setname(\"\");\r\n    setcategory(\"\");\r\n  };\r\n\r\n  // mets a jours la page de l'affichage\r\n  const updatePage = (i) => dispatch(setFiltre({ page: i + 1 }));\r\n\r\n  return {\r\n    annonces,\r\n    filtre,\r\n    nbrPages,\r\n    isLoading,\r\n    name,\r\n    category,\r\n    searchProduit,\r\n    resetSearch,\r\n    updatePage,\r\n    setname,\r\n    setcategory,\r\n  };\r\n};\r\n\r\nexport default useAccueil;\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SACEC,WAAW,EACXC,SAAS,EACTC,KAAK,QACA,qCAAqC;AAC5C,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACvB,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAMW,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAE9B,MAAM;IAAEW,QAAQ;IAAEC,MAAM;IAAEC;EAAS,CAAC,GAAGZ,WAAW,CAAEa,KAAK,IAAKA,KAAK,CAACC,OAAO,CAAC;EAC5E,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGlB,QAAQ,CAACa,MAAM,CAACI,IAAI,CAAC;EAC7C,MAAM,CAACE,QAAQ,EAAEC,WAAW,CAAC,GAAGpB,QAAQ,CAACa,MAAM,CAACM,QAAQ,CAAC;;EAEzD;EACApB,SAAS,CAAC,MAAM;IACdW,YAAY,CAAC,IAAI,CAAC;IAClB,IAAIW,SAAS,GAAI,QAAOR,MAAM,CAACI,IAAK,aAAYJ,MAAM,CAACM,QAAS,SAAQN,MAAM,CAACS,IAAK,EAAC;IACrFhB,KAAK,CACFiB,GAAG,CAAE,gBAAeF,SAAU,EAAC,CAAC,CAChCG,IAAI,CAAEC,GAAG,IAAKd,QAAQ,CAACR,WAAW,CAACsB,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAC9CC,KAAK,CAAEC,GAAG,IAAKC,OAAO,CAACC,GAAG,CAACF,GAAG,CAACG,QAAQ,CAAC,CAAC,CACzCC,OAAO,CAAC,MAAMtB,YAAY,CAAC,KAAK,CAAC,CAAC;EACvC,CAAC,EAAE,CAACC,QAAQ,EAAEE,MAAM,CAAC,CAAC;;EAEtB;EACA,MAAMoB,aAAa,GAAGA,CAAA,KAAMtB,QAAQ,CAACP,SAAS,CAAC;IAAEa,IAAI;IAAEE;EAAS,CAAC,CAAC,CAAC;;EAEnE;EACA,MAAMe,WAAW,GAAGA,CAAA,KAAM;IACxBvB,QAAQ,CAACN,KAAK,CAAC,CAAC,CAAC;IACjBa,OAAO,CAAC,EAAE,CAAC;IACXE,WAAW,CAAC,EAAE,CAAC;EACjB,CAAC;;EAED;EACA,MAAMe,UAAU,GAAIC,CAAC,IAAKzB,QAAQ,CAACP,SAAS,CAAC;IAAEkB,IAAI,EAAEc,CAAC,GAAG;EAAE,CAAC,CAAC,CAAC;EAE9D,OAAO;IACLxB,QAAQ;IACRC,MAAM;IACNC,QAAQ;IACRL,SAAS;IACTQ,IAAI;IACJE,QAAQ;IACRc,aAAa;IACbC,WAAW;IACXC,UAAU;IACVjB,OAAO;IACPE;EACF,CAAC;AACH,CAAC;AAACZ,EAAA,CA7CID,UAAU;EAAA,QAEGN,WAAW,EAEWC,WAAW;AAAA;AA2CpD,eAAeK,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}